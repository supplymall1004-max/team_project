# 식약처 의약품안전나라 API 설정 가이드

## 공공데이터포털에서 API 키 발급받기

### 1단계: 공공데이터포털 접속 및 로그인

1. [공공데이터포털(data.go.kr)](https://www.data.go.kr) 접속
2. 회원가입 또는 로그인

### 2단계: API 검색

공공데이터포털 검색창에서 다음 중 하나로 검색하세요:

#### 방법 1: 간단한 검색어 (추천)
```
의약품안전나라
```

#### 방법 2: 서비스 ID로 검색
```
1471000
```

#### 방법 3: 제공기관으로 검색
```
식약처 의약품
```

### 3단계: 서비스 선택

검색 결과에서 다음 서비스를 찾아 선택하세요:

- **서비스명**: "의약품안전나라서비스01" 또는 "의약품안전나라서비스"
- **제공기관**: 식품의약품안전처
- **서비스 ID**: 1471000

### 4단계: 활용신청

1. 서비스 상세 페이지에서 **"활용신청"** 버튼 클릭
2. 활용 목적 작성 (예: "건강 관리 앱에서 의약품 정보 조회")
3. 신청 완료 후 승인 대기 (보통 즉시 승인)

### 5단계: API 키 확인

1. 공공데이터포털 메인 페이지에서 **"마이페이지"** 클릭
2. **"활용중인 오픈API"** 메뉴 선택
3. "의약품안전나라서비스01" 선택
4. **"인증키(서비스키)"** 복사

### 6단계: 환경 변수 설정

프로젝트 루트의 `.env.local` 파일에 추가:

```env
MFDS_API_KEY=발급받은_서비스키_여기에_붙여넣기
```

### 7단계: 서버 재시작

```bash
# 개발 서버 재시작
pnpm dev
```

---

## API 키 없이도 사용 가능

**중요**: API 키가 없어도 다음 기능들은 정상 작동합니다:

✅ 약물 상호작용 체크 (로컬 데이터베이스 사용)
✅ 약물 복용 알림 시스템
✅ 건강 대시보드
✅ 가족 건강 관리

API 키는 **약물 정보를 자동으로 조회**할 때만 필요합니다.

---

## 문제 해결

### Q: 검색 결과가 나오지 않아요

**A**: 다음을 시도해보세요:
1. 검색어를 "의약품"만 입력
2. 제공기관 필터에서 "식품의약품안전처" 선택
3. 직접 링크: [공공데이터포털 의약품 검색](https://www.data.go.kr/tcs/dss/selectApiDataDetailView.do?publicDataPk=15000108)

### Q: 활용신청이 거부되었어요

**A**: 
- 활용 목적을 더 구체적으로 작성해보세요
- 예: "개인 건강 관리 앱에서 사용자가 복용 중인 의약품 정보를 조회하여 약물 상호작용을 확인하기 위함"

### Q: API 키를 발급받았는데 작동하지 않아요

**A**:
1. `.env.local` 파일에 정확히 입력했는지 확인
2. 서버를 재시작했는지 확인
3. API 키 앞뒤에 공백이 없는지 확인
4. 환경 변수 이름이 정확히 `MFDS_API_KEY`인지 확인

---

## API 사용 예시

API 키를 설정하면 다음과 같이 사용할 수 있습니다:

```typescript
import { searchMedicationByName } from '@/lib/mfds/medication-info-client';

// 약물명으로 검색
const result = await searchMedicationByName('타이레놀');
console.log(result.items); // 의약품 정보 배열
```

---

**작성일**: 2025년 12월 10일  
**버전**: V1.0

