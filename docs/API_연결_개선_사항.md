# 식약처 API 연결 개선 사항

## 변경 사항

### 1. 배치 크기 감소
- **이전**: 100개씩 한 번에 요청
- **현재**: 10개씩 작은 배치로 요청
- **효과**: API 부하 감소, 타임아웃 가능성 감소

### 2. 단계별 데이터 수집
- **1단계**: 레시피 기본 정보만 먼저 조회 (RCP_SEQ, RCP_NM 등)
- **2단계**: 각 레시피를 개별적으로 처리하여 상세 정보 저장
- **효과**: 데이터 수집 안정성 향상

### 3. 진행 상황 저장
- **기능**: 중단 시 진행 상황을 파일로 저장
- **위치**: `docs/mfds-recipes/.progress.json`
- **효과**: 중단 후 재개 가능

### 4. 타임아웃 조정
- **이전**: 60초
- **현재**: 15초 (작은 배치용)
- **효과**: 빠른 실패 감지, 재시도 빨라짐

### 5. 대기 시간 추가
- **레시피 간**: 200ms 대기
- **배치 간**: 2초 대기
- **효과**: API 서버 부하 감소

## 현재 문제

여전히 API 연결이 타임아웃되고 있습니다. 가능한 원인:

1. **네트워크 문제**
   - 방화벽/프록시 차단
   - VPN 사용
   - 인터넷 연결 불안정

2. **API 서버 문제**
   - 식약처 API 서버 장애
   - 서버 과부하

3. **API 키 문제**
   - API 키가 유효하지 않음
   - API 키 사용 승인 미완료

## 해결 방법

### 방법 1: 브라우저에서 직접 테스트

브라우저 주소창에 다음 URL 입력:

```
http://openapi.foodsafetykorea.go.kr/api/4e7ac25e7b614d039a99/COOKRCP01/json/1/10
```

**예상 결과:**
- ✅ 성공: JSON 데이터 표시
- ❌ 실패: 에러 메시지 또는 빈 페이지

### 방법 2: API 키 재확인

1. [공공데이터포털](https://www.data.go.kr) 접속
2. 마이페이지 → 활용중인 오픈API
3. "조리식품 레시피 DB" 서비스 확인
4. 인증키(서비스키) 확인 및 재발급

### 방법 3: 네트워크 환경 확인

- 방화벽 설정 확인
- 프록시 설정 확인
- VPN 사용 여부 확인
- 다른 네트워크에서 테스트

## 다음 단계

1. 브라우저에서 직접 API URL 테스트
2. 결과에 따라 추가 조치 결정
3. API 연결이 해결되면 데이터 수집 스크립트 재실행

